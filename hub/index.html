

<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <script type="text/javascript" src="/assets/js/jquery-3.6.0.js"></script>
</head>
<body>
  <pre id="main">
</pre>
<script>

var data = `
[{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/slider_switch/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.re.imageswitch",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/click_button/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.re.imageclick",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/pressrelease_button/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.re.imageprerel",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/momentary_push_button/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.re.imagepush",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/generic_push_button/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.re.imagecomplex",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/generic_latching_button/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.lv.switchbutton",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/generic_button/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.lv.button",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/multiple_state_button/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.lv.imagemultistate",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/image_list/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.imagelist",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/animation/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.animation",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/scrolling_label/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.lv.label",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/datetime_label/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.lv.datetimelabel",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/image_label/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.label",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/digits/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot_digit",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/circular_progress_bar/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.lv.arcimage",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/circular_meter/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.lv.linemeter",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/generic_progress_bar/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.lv.bar",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/horizontal_slider/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot_slider_hori_2",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/standard_widget_library/vertical_slider/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot_slider_veri_2",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/system_widget_library/retained_data/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.systemretaineddata",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/system_widget_library/popup_window/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.popupwin",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/system_widget_library/popup_inputpad/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.inputpad",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/system_widget_library/popup_messagebox/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.messagebox",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/system_widget_library/register_observer/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.regobserver",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/system_widget_library/timer/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.timer",
    "ver": "1.0.0"
},{
    "url": "/zh-tw/3.3.0/widgets/system_widget_library/audio_player/",
    "ade": "3.3.0",
    "lang": "zh-tw",
    "id": "iot.se.wavefileplayer",
    "ver": "1.0.0"
}]
`;

var sURL = {};
sURL.init = function() {
  sURL.PageURL = window.location.search.substring(1);
  sURL.Variables = sURL.PageURL.split('&');
  sURL.Param = {};
  sURL.Variables.forEach(function(element){
    var sParameterName = element.split('=');
    if (sParameterName[0] != '' ) {
      sURL.Param[sParameterName[0].toLowerCase()] = sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
    }
  });
}

$(document).ready(function () {
    let entries = JSON.parse(data);
    console.log("entries:", entries);
    sURL.init();
    console.log("lang:", sURL.Param['lang']);
    console.log("id:", sURL.Param['id']);
    console.log("ade:", sURL.Param['ade']);
    console.log("ver:", sURL.Param['ver']);
    let redirect_entry = entries.find(function (element) {
      return element['id'] == sURL.Param['id' ] && element['ver'] == sURL.Param['ver'] && element['ade'] == sURL.Param['ade'] && element['ver'] == sURL.Param['ver'];
    });
    console.log("redirect_entry:", redirect_entry);
    if(redirect_entry && redirect_entry.url) {
      window.location.href = redirect_entry.url;
    }
    else {
      //window.location.href = '/';
      // for debug, redirect after 30 seconds
      let body_html = `
<h3>
  Redirecting to / after <span id="countdown">30</span> seconds
</h3>
<pre id="info">
</pre>
`;
      $(document.body).html(body_html);
      var seconds = 30;
    
      var countdown = function() {
        seconds = seconds - 1;
        if (seconds < 0) {
            window.location = "/";
        } else {
            // Update remaining seconds
            document.getElementById("countdown").innerHTML = seconds;
            // Count down using javascript
            window.setTimeout(countdown, 1000);
        }
      }  
      countdown();
    }
    $("#info").append("lang: " + sURL.Param['lang']);
    $("#info").append("\nid: " + sURL.Param['id']);
    $("#info").append("\nade: " + sURL.Param['ade']);
    $("#info").append("\nver: " + sURL.Param['ver']);
    // TODO: widget id change
    // TODO: new ADE with old widget ver
});
</script>


</body>
</html>


